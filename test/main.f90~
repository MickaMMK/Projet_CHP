program test
  use grad_conj
  implicit none

  real(wp), dimension(40,40)    :: A
  real(wp), dimension(40)       :: B, X
  integer                       :: i, j

  A = 0._wp

  do i = 1, 40
     A(i,i) = 4._wp
  enddo

  do i = 1, 39
     A(i+1,i) = -1._wp
     A(i,i+1) = -1._wp
  enddo

  B = 1._wp

  call grad_conj_opt(A,X,B)

  X = matmul(A,X)
  X = X - B
  X = abs(X)
  print*,sum(X),'cest z√©ro ?'
  print*,X

end program test

